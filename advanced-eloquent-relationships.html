<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Eloquent Relationships in Laravel</title>
    <link rel="stylesheet" href="advanced-eloquent-relationships.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container py-5">
        <div class="d-flex align-items-center mb-4">
            <i class="fa-solid fa-database fa-2x me-3 text-primary"></i>
            <div>
                <h1 class="mb-0">Advanced Eloquent Relationships in Laravel</h1>
                <div class="d-flex flex-wrap align-items-center mt-2">
                    <span class="badge bg-info me-2">Laravel Advanced</span>
                    <span class="badge bg-secondary me-2">Duration: 90 minutes</span>
                    <span class="badge bg-warning text-dark">Difficulty: Intermediate–Senior</span>
                </div>
            </div>
        </div>
        <section class="mb-5">
            <h2>Introduction</h2>
            <p>This lecture dives deep into advanced Eloquent relationships in Laravel, helping you master complex data modeling and querying techniques. Whether you’re a junior looking to level up or a senior developer seeking best practices, you’ll find practical insights, real-life analogies, and hands-on code examples here.</p>
            <div class="alert alert-secondary mt-3" role="alert">
                <strong>يعني إيه العلاقات المتقدمة في Eloquent؟</strong><br>
                بص يا معلم، الموضوع زي العلاقات بين الناس في العيلة الكبيرة. كل واحد ليه دور، وكل علاقة ليها تفاصيلها. Laravel بيساعدك تدير العلاقات دي بين الجداول بسهولة وذكاء.
            </div>
        </section>
        <section class="mb-5">
            <h2>Main Concepts</h2>
            <div class="accordion" id="conceptsAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            1. Polymorphic Relationships
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#conceptsAccordion">
                        <div class="accordion-body">
                            <p>Polymorphic relationships allow a model to belong to more than one other model on a single association. For example, a <code>Comment</code> model might belong to both <code>Post</code> and <code>Video</code> models.</p>
                            <pre><code class="language-php">// Comment.php
public function commentable()
{
    return $this->morphTo();
}</code></pre>
                            <div class="alert alert-secondary mt-3" role="alert">
                                <strong>شرح بالمصري:</strong><br>
                                تخيل عندك تعليقات على بوستات وفيديوهات. بدل ما تعمل جدول تعليقات لكل نوع، بتخلي التعليق يقدر يرتبط بأي نوع منهم. زي ما تقول "أي حد يقدر يعلق هنا".
                            </div>
                            <div class="mt-3">
                                <strong>Advanced Tip:</strong> Use morph maps to avoid exposing class names in your database.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            2. Many-to-Many Relationships with Extra Pivot Data
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#conceptsAccordion">
                        <div class="accordion-body">
                            <p>Sometimes, you need to store extra information on the pivot table of a many-to-many relationship. For example, a <code>User</code> can belong to many <code>Teams</code>, and you want to store the user's role in each team.</p>
                            <pre><code class="language-php">// User.php
public function teams()
{
    return $this->belongsToMany(Team::class)->withPivot('role');
}</code></pre>
                            <div class="alert alert-secondary mt-3" role="alert">
                                <strong>شرح بالمصري:</strong><br>
                                زي ما يكون عندك موظف شغال في كذا مشروع، وكل مشروع ليه دور مختلف. بتسجل الدور ده في الجدول اللي بيربط الموظف بالمشاريع.
                            </div>
                            <div class="mt-3">
                                <strong>Advanced Tip:</strong> Use <code>withTimestamps()</code> to automatically manage created/updated times on the pivot.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            3. Has Many Through
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#conceptsAccordion">
                        <div class="accordion-body">
                            <p>The <code>hasManyThrough</code> relationship provides a convenient shortcut for accessing distant relations via an intermediate model. For example, a <code>Country</code> has many <code>Posts</code> through <code>Users</code>.</p>
                            <pre><code class="language-php">// Country.php
public function posts()
{
    return $this->hasManyThrough(Post::class, User::class);
}</code></pre>
                            <div class="alert alert-secondary mt-3" role="alert">
                                <strong>شرح بالمصري:</strong><br>
                                زي ما تقول "كل بلد ليها ناس، وكل واحد ليه بوستات". بدل ما تلف على كل واحد وتشوف بوستاته، Laravel بيجيبلك كل البوستات مرة واحدة.
                            </div>
                            <div class="mt-3">
                                <strong>Advanced Tip:</strong> You can add constraints to the intermediate model for more advanced queries.
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Add more advanced concepts as needed -->
            </div>
        </section>
        <section class="mb-5">
            <h2>Code Examples</h2>
            <div class="mb-4">
                <h5>Example: Defining a Polymorphic Relationship</h5>
                <pre><code class="language-php">// Migration for comments table
Schema::create('comments', function (Blueprint $table) {
    $table->id();
    $table->text('body');
    $table->morphs('commentable');
    $table->timestamps();
});</code></pre>
                <div class="alert alert-secondary mt-3" role="alert">
                    <strong>شرح بالمصري:</strong><br>
                    هنا بنقول للجدول: "خلي عندك عمودين، واحد بيقول التعليق ده يخص إيه (النوع)، والتاني بيقول يخص مين (الرقم)".
                </div>
            </div>
            <div class="mb-4">
                <h5>Example: Querying with Constraints</h5>
                <pre><code class="language-php">// Get all comments for a specific post
$post = Post::find(1);
$comments = $post->comments()->where('approved', true)->get();</code></pre>
                <div class="alert alert-secondary mt-3" role="alert">
                    <strong>شرح بالمصري:</strong><br>
                    يعني لو عايز تجيب كل التعليقات اللي اتوافقت بس على بوست معين، بتستخدم الكود ده.
                </div>
            </div>
        </section>
        <section class="mb-5">
            <h2>Real-life Analogies</h2>
            <ul class="list-group">
                <li class="list-group-item">
                    <strong>Polymorphic:</strong> زي ما يكون عندك صندوق بريد واحد بيستقبل جوابات من كذا حد (بوست أو فيديو).
                </li>
                <li class="list-group-item">
                    <strong>Pivot Data:</strong> زي دفتر حضور وانصراف فيه اسم الموظف والمشروع والدور بتاعه.
                </li>
                <li class="list-group-item">
                    <strong>Has Many Through:</strong> زي ما يكون عندك مدير عايز يعرف كل الشغل اللي اتعمل في الشركة من خلال الموظفين.
                </li>
            </ul>
        </section>
        <section class="mb-5">
            <h2>Advanced Tips</h2>
            <ul class="list-group">
                <li class="list-group-item">Use eager loading (<code>with()</code>) to optimize queries and avoid N+1 problems.</li>
                <li class="list-group-item">Leverage custom pivot models for more complex pivot table logic.</li>
                <li class="list-group-item">Understand the difference between <code>morphOne</code> and <code>morphMany</code> for correct relationship mapping.</li>
                <li class="list-group-item">Use accessors and mutators to format relationship data on the fly.</li>
            </ul>
        </section>
        <section class="mb-5">
            <h2>Quiz: Test Your Knowledge</h2>
            <form id="quizForm">
                <div class="mb-3">
                    <label class="form-label">1. What does a polymorphic relationship allow?</label>
                    <div>
                        <input type="radio" name="q1" value="a"> A model to belong to multiple other models on a single association<br>
                        <input type="radio" name="q1" value="b"> A model to have only one parent<br>
                        <input type="radio" name="q1" value="c"> Only one-to-one relationships<br>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">2. Where do you store extra data in a many-to-many relationship?</label>
                    <div>
                        <input type="radio" name="q2" value="a"> In the main model<br>
                        <input type="radio" name="q2" value="b"> In the pivot table<br>
                        <input type="radio" name="q2" value="c"> In a separate log file<br>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">3. What is the purpose of <code>hasManyThrough</code>?</label>
                    <div>
                        <input type="radio" name="q3" value="a"> To access distant relations via an intermediate model<br>
                        <input type="radio" name="q3" value="b"> To create a direct one-to-one relationship<br>
                        <input type="radio" name="q3" value="c"> To store pivot data<br>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">4. Which method helps avoid N+1 query problems?</label>
                    <div>
                        <input type="radio" name="q4" value="a"> with()<br>
                        <input type="radio" name="q4" value="b"> find()<br>
                        <input type="radio" name="q4" value="c"> save()<br>
                    </div>
                </div>
                <button type="button" class="btn btn-primary" id="submitQuiz">Submit Quiz</button>
                <div id="quizResult" class="mt-3"></div>
            </form>
        </section>
        <div class="d-flex justify-content-end">
            <button class="btn btn-success" id="markCompleted"><i class="fa-solid fa-check"></i> Mark as Completed</button>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="advanced-eloquent-relationships.js"></script>
</body>
</html>